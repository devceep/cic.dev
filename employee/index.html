<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CIC Competency Framework System - Employee Portal">
    <title>Employee Portal - CIC Competency Framework</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.6.0/jspdf.plugin.autotable.min.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/styles.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>

<body>
    <!-- Sidebar Overlay (Mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="../assets/CIC-logo.png" alt="CIC Logo" class="sidebar-logo"
                style="width: 60px; height: 60px; object-fit: contain;">
            <div>
                <h1 class="text-lg font-bold">Employee Portal</h1>
                <p class="text-xs text-blue-200">Competency Framework</p>
            </div>
        </div>

        <nav class="sidebar-nav">
            <!-- Main Navigation -->
            <div class="nav-section">
                <div class="nav-section-title">Main</div>
                <a class="nav-item active" data-view="dashboard" onclick="showView('dashboard')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    <span>Dashboard</span>
                </a>
                <a class="nav-item" data-view="competency-library" onclick="showView('competency-library')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    <span>Competency Library</span>
                </a>
            </div>

            <!-- Assessment Section -->
            <div class="nav-section">
                <div class="nav-section-title">My Assessments</div>
                <a class="nav-item" data-view="self-assessment" onclick="showView('self-assessment')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                    </svg>
                    <span>Self Assessment</span>
                    <span class="nav-badge" id="selfAssessmentBadge">1</span>
                </a>
                <a class="nav-item" data-view="rate-peers" onclick="showView('rate-peers')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span>Rate My Peers</span>
                    <span class="nav-badge" id="peerRatingBadge">0</span>
                </a>
                <a class="nav-item" data-view="my-gap-analysis" onclick="showView('my-gap-analysis')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                    <span>My Gap Analysis</span>
                </a>
                <a class="nav-item" data-view="development-plan" onclick="showView('development-plan')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                    </svg>
                    <span>Development Plan</span>
                </a>
            </div>

            <!-- Supervisor Section (Conditional) -->
            <div class="nav-section hidden" id="supervisorSection">
                <div class="nav-section-title">
                    <span class="badge badge-warning" style="font-size: 0.65rem; padding: 2px 6px;">Supervisor</span>
                </div>
                <a class="nav-item" data-view="my-subordinates" onclick="showView('my-subordinates')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    <span>My Subordinates</span>
                </a>
                <a class="nav-item" data-view="superior-assessment" onclick="showView('superior-assessment')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                    </svg>
                    <span>Rate Subordinates</span>
                    <span class="nav-badge" id="superiorAssessmentBadge">0</span>
                </a>
                <a class="nav-item" data-view="team-gap-analysis" onclick="showView('team-gap-analysis')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                    </svg>
                    <span>Team Gap Analysis</span>
                </a>
            </div>

            <!-- Settings -->
            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <a class="nav-item" data-view="profile" onclick="showView('profile')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span>My Profile</span>
                </a>
                <a class="nav-item" onclick="handleLogout()">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    <span>Sign Out</span>
                </a>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <h2 class="header-title" id="pageTitle">Dashboard</h2>
            </div>
            <div class="header-right">
                <div class="header-user" id="headerUser">
                    <div class="user-avatar" id="userAvatar">--</div>
                    <div class="hidden sm:block">
                        <p class="text-sm font-medium" id="userName">Loading...</p>
                        <p class="text-xs text-gray-500" id="userPosition">Loading...</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content Container -->
        <div class="p-4 md:p-6">

            <!-- ============================================================ -->
            <!-- DASHBOARD VIEW -->
            <!-- ============================================================ -->
            <section id="view-dashboard" class="view-section">
                <!-- Welcome Banner -->
                <div class="card mb-6" style="background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);">
                    <div class="card-body text-white">
                        <h2 class="text-xl font-bold mb-1" id="welcomeMessage">Welcome back!</h2>
                        <p class="text-blue-200" id="cycleStatus">Current Assessment Cycle: Loading...</p>
                    </div>
                </div>

                <!-- Assessment Status Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="card stat-card">
                        <div class="stat-icon blue">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Self Assessment</p>
                            <p class="stat-value" id="selfAssessmentStatus">Pending</p>
                            <p class="stat-change" id="selfAssessmentDeadline">Due: --</p>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon yellow">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Peer Reviews To Do</p>
                            <p class="stat-value" id="peerReviewCount">0</p>
                            <p class="stat-change">Assigned by HR</p>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon green">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Competencies Met</p>
                            <p class="stat-value" id="competenciesMetCount">-</p>
                            <p class="stat-change positive">Based on weighted scores</p>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon red">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Development Needs</p>
                            <p class="stat-value" id="developmentNeedsCount">-</p>
                            <p class="stat-change negative">Areas to improve</p>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card lg:col-span-2">
                        <div class="card-header">
                            <h3 class="card-title">My Assessment Progress</h3>
                        </div>
                        <div class="card-body">
                            <div class="step-progress mb-6">
                                <div class="step-item">
                                    <div class="step-circle active" id="empStepSelf">1</div>
                                </div>
                                <div class="step-line" id="empLineSelfPeer"></div>
                                <div class="step-item">
                                    <div class="step-circle pending" id="empStepPeer">2</div>
                                </div>
                                <div class="step-line" id="empLinePeerSuperior"></div>
                                <div class="step-item">
                                    <div class="step-circle pending" id="empStepSuperior">3</div>
                                </div>
                                <div class="step-line" id="empLineSuperiorComplete"></div>
                                <div class="step-item">
                                    <div class="step-circle pending" id="empStepComplete">âœ“</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center text-sm">
                                <div>
                                    <p class="font-medium text-blue-600">Self Assessment</p>
                                    <p class="text-gray-500">Rate yourself</p>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-400">Peer Assessment</p>
                                    <p class="text-gray-400">Colleagues rate you</p>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-400">Superior Assessment</p>
                                    <p class="text-gray-400">Supervisor rates you</p>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-400">Results</p>
                                    <p class="text-gray-400">View gap analysis</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary" onclick="showView('self-assessment')">
                                Start Self Assessment
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Quick Actions</h3>
                        </div>
                        <div class="card-body space-y-3">
                            <button class="btn btn-secondary w-full justify-start"
                                onclick="showView('self-assessment')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                </svg>
                                Complete Self Assessment
                            </button>
                            <button class="btn btn-secondary w-full justify-start" onclick="showView('rate-peers')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                Rate My Peers
                            </button>
                            <button class="btn btn-secondary w-full justify-start"
                                onclick="showView('my-gap-analysis')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                View My Gap Analysis
                            </button>
                            <button class="btn btn-secondary w-full justify-start"
                                onclick="showView('development-plan')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                                </svg>
                                My Development Plan
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- COMPETENCY LIBRARY VIEW (Read-Only) -->
            <!-- ============================================================ -->
            <section id="view-competency-library" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Competency Library</h2>
                    <p class="text-gray-600">Browse competencies required for your position (CSC MC No. 05, s. 2016)</p>
                </div>

                <!-- Filter Tabs -->
                <div class="flex gap-2 mb-6 flex-wrap">
                    <button class="btn btn-primary" onclick="filterCompetencies('all')" id="filterAll">All</button>
                    <button class="btn btn-secondary" onclick="filterCompetencies('Core')" id="filterCore">Core
                        (CIC)</button>
                    <button class="btn btn-secondary" onclick="filterCompetencies('Leadership')"
                        id="filterLeadership">Leadership (CSC)</button>
                    <button class="btn btn-secondary" onclick="filterCompetencies('Functional')"
                        id="filterFunctional">Functional (CIC)</button>
                </div>

                <!-- Competency Cards Container -->
                <div id="competencyLibraryContainer" class="space-y-4">
                    <!-- Competency cards will be dynamically inserted here -->
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- SELF ASSESSMENT VIEW -->
            <!-- ============================================================ -->
            <section id="view-self-assessment" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Self Assessment</h2>
                    <p class="text-gray-600">Rate your proficiency level for each competency based on your current
                        performance.</p>
                </div>

                <!-- Position Info -->
                <div class="card mb-6">
                    <div class="card-body">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <p class="text-sm text-gray-500">Your Position</p>
                                <p class="font-medium" id="empPositionName">Loading...</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Required Level</p>
                                <span class="badge badge-info" id="empRequiredLevel">--</span>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Assessment Status</p>
                                <span class="badge badge-warning" id="empAssessmentStatus">Pending</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Assessment Form -->
                <form id="selfAssessmentForm" onsubmit="submitSelfAssessment(event)">
                    <div id="assessmentFormContainer">
                        <!-- Assessment items will be dynamically inserted here -->
                    </div>

                    <div id="assessmentSubmitSection" class="hidden mt-6">
                        <div class="card">
                            <div class="card-body flex justify-between items-center">
                                <div>
                                    <p class="font-medium text-gray-900">Ready to submit?</p>
                                    <p class="text-sm text-gray-500">Make sure you've rated all competencies before
                                        submitting.</p>
                                </div>
                                <button type="submit" class="btn btn-success btn-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M5 13l4 4L19 7" />
                                    </svg>
                                    Submit Self Assessment
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </section>

            <!-- ============================================================ -->
            <!-- RATE MY PEERS VIEW -->
            <!-- ============================================================ -->
            <section id="view-rate-peers" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Rate My Peers</h2>
                    <p class="text-gray-600">Complete anonymous assessments for colleagues assigned to you by HR.</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Assigned Peer Assessments</h3>
                        <span class="badge badge-anonymous">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Your ratings are anonymous
                        </span>
                    </div>
                    <div class="card-body" id="peerAssignmentsContainer">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <p class="empty-title">No Peer Assessments Assigned</p>
                            <p class="empty-description">HR has not assigned any peer assessments to you yet. Check back
                                later or contact HR for more information.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- MY GAP ANALYSIS VIEW -->
            <!-- ============================================================ -->
            <section id="view-my-gap-analysis" class="view-section hidden">
                <div class="mb-6 flex justify-between items-start flex-wrap gap-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">My Gap Analysis</h2>
                        <p class="text-gray-600">View your competency ratings and development needs.</p>
                    </div>
                    <button class="btn btn-secondary" onclick="downloadGapAnalysisPDF()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        Download PDF
                    </button>
                </div>

                <!-- Gap Analysis Content -->
                <div id="gapAnalysisContent">
                    <div class="card">
                        <div class="card-body">
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                    </svg>
                                </div>
                                <p class="empty-title">Complete Your Assessment First</p>
                                <p class="empty-description">Gap analysis will be available after your 360-degree
                                    assessment is complete (Self, Peer, and Superior ratings).</p>
                                <button class="btn btn-primary mt-4" onclick="showView('self-assessment')">Start Self
                                    Assessment</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- DEVELOPMENT PLAN VIEW -->
            <!-- ============================================================ -->
            <section id="view-development-plan" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">My Development Plan</h2>
                    <p class="text-gray-600">Create and track your Individual Development Plan (IDP) based on your gap
                        analysis.</p>
                </div>

                <div id="developmentPlanContent">
                    <div class="card">
                        <div class="card-body">
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                                    </svg>
                                </div>
                                <p class="empty-title">No Development Plan Yet</p>
                                <p class="empty-description">Complete your gap analysis to identify development needs,
                                    then create activities to address them.</p>
                                <button class="btn btn-primary mt-4" onclick="showView('my-gap-analysis')">View Gap
                                    Analysis</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- SUPERVISOR: MY SUBORDINATES VIEW -->
            <!-- ============================================================ -->
            <section id="view-my-subordinates" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">My Subordinates</h2>
                    <p class="text-gray-600">View your direct reports and their assessment status.</p>
                </div>

                <div class="card">
                    <div class="card-body" id="subordinatesContainer">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                </svg>
                            </div>
                            <p class="empty-title">No Subordinates Found</p>
                            <p class="empty-description">You don't have any direct reports assigned yet, or they haven't
                                registered in the system.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- SUPERVISOR: RATE SUBORDINATES VIEW -->
            <!-- ============================================================ -->
            <section id="view-superior-assessment" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Rate Subordinates</h2>
                    <p class="text-gray-600">Complete superior assessments for your direct reports.</p>
                </div>

                <div class="card">
                    <div class="card-body" id="superiorAssessmentsContainer">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                </svg>
                            </div>
                            <p class="empty-title">No Pending Superior Assessments</p>
                            <p class="empty-description">You don't have any subordinate assessments to complete right
                                now.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- SUPERVISOR: TEAM GAP ANALYSIS VIEW -->
            <!-- ============================================================ -->
            <section id="view-team-gap-analysis" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Team Gap Analysis</h2>
                    <p class="text-gray-600">View aggregated competency gaps for your team.</p>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                                </svg>
                            </div>
                            <p class="empty-title">Team Analysis Not Available</p>
                            <p class="empty-description">Team gap analysis will be available once your subordinates
                                complete their assessments.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================================ -->
            <!-- PROFILE VIEW -->
            <!-- ============================================================ -->
            <section id="view-profile" class="view-section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">My Profile</h2>
                    <p class="text-gray-600">View and update your account information.</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card lg:col-span-2">
                        <div class="card-header">
                            <h3 class="card-title">Profile Information</h3>
                        </div>
                        <div class="card-body">
                            <form id="profileForm" onsubmit="updateProfile(event)">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Full Name</label>
                                        <input type="text" class="form-input" id="profileName" placeholder="Your name">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Email Address</label>
                                        <input type="email" class="form-input" id="profileEmail" disabled>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Department</label>
                                        <input type="text" class="form-input" id="profileDepartment" disabled>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Position</label>
                                        <input type="text" class="form-input" id="profilePositionTitle" disabled>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Account</h3>
                        </div>
                        <div class="card-body">
                            <div class="text-center mb-6">
                                <div class="user-avatar w-20 h-20 text-2xl mx-auto mb-4" id="profileAvatar">--</div>
                                <h4 class="font-semibold text-lg" id="profileDisplayName">Loading...</h4>
                                <p class="text-gray-500" id="profileDisplayPosition">Loading...</p>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-500">Role</span>
                                    <span class="badge badge-info" id="profileRole">Employee</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-500">Required Level</span>
                                    <span class="font-medium" id="profileRequiredLevel">--</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-500">Supervisor</span>
                                    <span class="badge badge-warning hidden" id="profileSupervisorBadge">Yes</span>
                                    <span class="font-medium" id="profileSupervisorStatus">No</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- ============================================================ -->
    <!-- PEER ASSESSMENT MODAL -->
    <!-- ============================================================ -->
    <div class="modal-overlay hidden" id="peerAssessmentModal">
        <div class="modal-container" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <span class="badge badge-anonymous mr-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Anonymous
                    </span>
                    Peer Assessment
                </h3>
                <button class="modal-close" onclick="closePeerAssessmentModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <form id="peerAssessmentForm" onsubmit="submitPeerAssessment(event)">
                <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
                    <!-- Subject Info -->
                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                        <p class="text-sm text-gray-500">Rating colleague:</p>
                        <p class="font-medium text-lg" id="peerSubjectName">Loading...</p>
                        <p class="text-sm text-gray-500" id="peerSubjectPosition">Loading...</p>
                    </div>

                    <p class="text-sm text-gray-600 mb-4">
                        Rate your colleague's proficiency on each competency. Your response is
                        <strong>anonymous</strong> and will be aggregated with other peer ratings.
                    </p>

                    <!-- Competency Rating Items -->
                    <div id="peerCompetencyRatings" class="space-y-4">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closePeerAssessmentModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        Submit Peer Rating
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ============================================================ -->
    <!-- DEVELOPMENT ACTIVITY MODAL -->
    <!-- ============================================================ -->
    <div class="modal-overlay hidden" id="addActivityModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Add Development Activity</h3>
                <button class="modal-close" onclick="closeAddActivityModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <form id="addActivityForm" onsubmit="submitDevelopmentActivity(event)">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Target Competency <span class="text-red-500">*</span></label>
                        <select class="form-select" id="activityCompetencyId" required>
                            <option value="">Select competency to develop...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Activity Title <span class="text-red-500">*</span></label>
                        <input type="text" class="form-input" id="activityTitle"
                            placeholder="e.g., Complete online leadership course" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Activity Type <span class="text-red-500">*</span></label>
                        <select class="form-select" id="activityType" required>
                            <option value="">Select type...</option>
                            <option value="training">Training/Course</option>
                            <option value="mentoring">Mentoring/Coaching</option>
                            <option value="assignment">Stretch Assignment</option>
                            <option value="selfstudy">Self-Study</option>
                            <option value="certification">Certification</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="form-group">
                            <label class="form-label">Target Start Date</label>
                            <input type="date" class="form-input" id="activityStartDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Target End Date</label>
                            <input type="date" class="form-input" id="activityEndDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-input" id="activityDescription" rows="3"
                            placeholder="Describe the learning activity..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddActivityModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Activity</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="spinner"></div>
        <p class="loading-text">Loading...</p>
    </div>

    <!-- Firebase Configuration -->
    <script src="../js/firebase-config.js"></script>

    <!-- Database Operations -->
    <script src="../js/database.js"></script>

    <!-- Auth Module -->
    <script src="../js/auth.js"></script>

    <!-- Charts Module -->
    <script src="../js/charts.js"></script>

    <!-- Reports Module -->
    <script src="../js/reports.js"></script>

    <!-- Employee App Controller -->
    <script src="../js/employee-app.js"></script>
</body>

</html>